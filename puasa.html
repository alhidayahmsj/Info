<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>INFO MASJID AL HIDAYAH</title>

<style>
body{
  font-family:Arial,sans-serif;
  margin:0;
  background:#146C1B;
  color:#fff;
  padding-bottom:80px;
}

/* HEADER */
header{
  display:flex;
  align-items:center;
  gap:10px;
  padding:12px 15px;
  background:#1A5917;
}
header img{width:40px;height:40px;}
header h1{margin:0;font-size:1.2rem;}
header p{margin:2px 0 0;font-size:.85rem;color:#ddd}

/* MENU */
nav{padding:15px;}
nav ul{list-style:none;margin:0;padding:0;}
nav li{margin-bottom:10px;position:relative;}
nav a{
  display:block;
  padding:12px;
  text-decoration:none;
  color:#fff;
  font-weight:bold;
  background:#338B2E;
  border-radius:12px;
}
nav a:hover{background:#0D6309;}
.toggle{
  position:absolute;
  right:15px;
  top:50%;
  transform:translateY(-50%);
  background:none;
  border:none;
  color:#fff;
  font-size:16px;
  cursor:pointer;
}
.submenu{
  max-height:0;
  overflow:hidden;
  transition:max-height .4s ease;
  margin-left:20px;
}
.submenu.show{max-height:800px;}
.submenu a{
  font-weight:normal;
  background:#0E6F14;
  border-radius:10px;
  font-size:.95rem;
  margin-top:5px;
}

/* SLIDESHOW */
.slideshow{
  width:100%;
  max-width:1000px;
  aspect-ratio:16/9;
  margin:20px auto 60px;
  position:relative;
  overflow:hidden;
  border-radius:15px;
  background:#000;
}
.slideshow img{
  width:100%;
  height:100%;
  object-fit:cover;
  position:absolute;
  opacity:0;
  transition:opacity 1s ease-in-out;
}
.slideshow img.active{opacity:1;}

/* RUNNING TEKS JADWAL SHOLAT */
.prayer-overlay{
  position:absolute;
  bottom:0;
  left:0;
  width:100%;
  background:rgba(0,0,0,.65);
  font-size:14px;
  padding:6px 0;
  overflow:hidden;
}
.prayer-marquee{
  white-space:nowrap;
  display:inline-block;
  padding-left:100%;
  animation:marquee 25s linear infinite;
}
@keyframes marquee{
  from{transform:translateX(0);}
  to{transform:translateX(-100%);}
}

/* FOOTER */
.credit{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  text-align:center;
  background:rgba(0,0,0,.3);
  padding:8px 0;
  font-size:14px;
  color:#ddd;
}
</style>
</head>

<body>

<header>
  <img src="logo.png">
  <div>
    <h1>MASJID AL HIDAYAH</h1>
    <p>Menyebarkan nilai-nilai Islam rahmatan lil ‘alamin</p>
  </div>
</header>

<nav>
<ul>
  <li><a href="https://bukitmsj.infinityfree.me/donasi/donasi.php" target="_blank">Donasi</a></li>

  <li>
    <a href="#">Info & Kegiatan</a>
    <button class="toggle">▼</button>
    <div class="submenu">
      <a href="Dkm.jpeg" target="_blank">Susunan Pengurus</a>
      <a href="sejarah.html">Sejarah Masjid</a>
      <a href="https://masjid.infinityfreeapp.com/alhidayah/jumat/kajian.mingguan.html">Jadwal Kajian</a>
      <a href="https://masjid.infinityfreeapp.com/alhidayah/laporan.keuangan.php/laporan.keuangan.php">Laporan Keuangan</a>
      <a href="quran-id.html">Qur'an Digital</a>
      <a href="https://masjid.infinityfreeapp.com/alhidayah/artikel/listartikel.php">Artikel</a>
    </div>
  </li>

  <li><a href="https://www.youtube.com/@alhidayah.bukitkencana">Rekaman Kajian</a></li>

  <li>
    <a href="#">Belajar Bahasa Arab</a>
    <button class="toggle">▼</button>
    <div class="submenu">
      <a href="https://ia601800.us.archive.org/14/items/eBook_Bhs_Arab_242/Panduan_Durusul_Lughah_al_Arabiyah_1.pdf">Durusul Lughah Jilid 1</a>
      <a href="https://ia801206.us.archive.org/1/items/Kitab_Terjemahan/Panduan_Durusul_Lughah_al_Arabiyyah_4.pdf">Durusul Lughah Jilid 4</a>
    </div>
  </li>

  <li><a href="https://alhidayahmsj.github.io/Live.masjidilharam/">Live Mekkah - Madinah</a></li>

  <li>
    <a href="#">Galeri Foto & Video</a>
    <button class="toggle">▼</button>
    <div class="submenu">
      <a href="https://drive.google.com/drive/folders/1FCzaeXZ8eLlgArKoFJM2trA1L35Mar1G">Foto</a>
      <a href="https://drive.google.com/drive/folders/1z1YnvwjZBNNIS2HYDSjhapydkBBqRzEt">Video</a>
    </div>
  </li>

  <li>
    <a href="#">Jadwal Sholat & Arah Kiblat</a>
    <button class="toggle">▼</button>
    <div class="submenu">
      <a href="https://masjid.infinityfreeapp.com/alhidayah/jumat/khatib.php">Sholat Jumat</a>
      <a href="https://masjid.infinityfreeapp.com/alhidayah/jumat/jadwal_alad.php">Jadwal Sholat</a>
      <a href="kiblat-online.html">Arah Kiblat</a>
    </div>
  </li>
</ul>
</nav>

<div class="slideshow">
  <img src="masjid1.jpg" class="slide active">
  <img src="masjid2.jpg" class="slide">
  <img src="masjid3.jpg" class="slide">
  <img src="masjid4.jpg" class="slide">

  <div class="prayer-overlay">
    <div id="prayerText" class="prayer-marquee">
      Memuat jadwal sholat...
    </div>
  </div>
</div>

<audio id="azanAudio" preload="auto">
  <source src="azan.mp3" type="audio/mpeg">
</audio>

<div class="credit">
Created By : Team Multi Media<br>
Masjid Al Hidayah
</div>

<script>
/* TOGGLE MENU */
document.querySelectorAll(".toggle").forEach(btn=>{
  btn.onclick=()=>{
    const s=btn.nextElementSibling;
    document.querySelectorAll(".submenu").forEach(x=>{
      if(x!==s) x.classList.remove("show");
    });
    s.classList.toggle("show");
    btn.textContent=s.classList.contains("show")?"▲":"▼";
  };
});

/* SLIDESHOW */
let i=0;
const slides=document.querySelectorAll(".slide");
setInterval(()=>{
  slides[i].classList.remove("active");
  i=(i+1)%slides.length;
  slides[i].classList.add("active");
},3000);

/* JADWAL SHOLAT GPS + IP FALLBACK (HP AMAN) */
(async()=>{
  const prayerText=document.getElementById("prayerText");
  const azan=document.getElementById("azanAudio");
  const today=new Date().toISOString().split("T")[0];

  async function cityByGPS(){
    return new Promise((ok,fail)=>{
      navigator.geolocation.getCurrentPosition(
        p=>ok(p.coords),
        ()=>fail(),
        {enableHighAccuracy:true,timeout:8000}
      );
    });
  }

  async function nearestCity(lat,lon){
    const r=await fetch("https://api.myquran.com/v2/sholat/kota/semua");
    const d=await r.json();
    let id=1301,min=Infinity;
    d.data.forEach(c=>{
      const dist=Math.hypot(c.latitude-lat,c.longitude-lon);
      if(dist<min){min=dist;id=c.id;}
    });
    return id;
  }

  async function cityByIP(){
    const ip=await fetch("https://ipapi.co/json/").then(r=>r.json());
    const kota=await fetch("https://api.myquran.com/v2/sholat/kota/semua").then(r=>r.json());
    const f=kota.data.find(c=>ip.city && c.lokasi.toLowerCase().includes(ip.city.toLowerCase()));
    return f?f.id:1301;
  }

  try{
    let cityID;
    try{
      const loc=await cityByGPS();
      cityID=await nearestCity(loc.latitude,loc.longitude);
    }catch{
      cityID=await cityByIP();
    }

    const res=await fetch(`https://api.myquran.com/v2/sholat/jadwal/${cityID}/${today}`);
    const j=(await res.json()).data.jadwal;

   const hari = new Date().toLocaleDateString("id-ID",{ weekday:"long" });

prayerText.textContent=
  `${hari} | Subuh ${j.subuh} | Dzuhur ${j.dzuhur} | Ashar ${j.ashar} | Maghrib ${j.maghrib} | Isya ${j.isya}`;

    const [h,m]=j.maghrib.split(":");
    const magrib=new Date(); magrib.setHours(h,m,0,0);
    let played=false;
    setInterval(()=>{
      if(!played && new Date()>=magrib){
        azan.play().catch(()=>{});
        played=true;
      }
    },1000);

  }catch{
    prayerText.textContent="Jadwal sholat tidak tersedia";
  }
})();
</script>

</body>
</html>